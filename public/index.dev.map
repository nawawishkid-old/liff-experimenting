{"version":3,"sources":["dom/field-description-effect.js","fieldNameParser.js","dom/form-validation.js","dom/index.js","index.js"],"names":["document","querySelectorAll","forEach","elem","addEventListener","e","console","log","notiDom","querySelector","dataset","for","method","classList","contains","add","parseManyFieldNames","fields","starterObj","delimiter","reduce","obj","field","parseFieldName","name","value","splittedName","split","keys","slice","key","index","isLastIndex","Array","isArray","isNaN","parseInt","Error","handleLastIndex","valueShouldBeArray","handleArrayProperty","handleNormal","slicedKey","prop","isPropExists","handleEachForm","form","elements","filter","tagName","handleEachField","preventDefault","validateField","liffMessageData","fieldNameParser","target","validity","validationMessage","messageDom","parentElement","valid","message","patternMismatch","errorMessagePattern","remove","innerHTML"],"mappings":"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","file":"index.dev.map","sourceRoot":"../src/client","sourcesContent":["document.querySelectorAll(\"form .field .description-icon\").forEach(elem =>\r\n  elem.addEventListener(\"click\", function(e) {\r\n    console.log(\"description icon clicked!\");\r\n    const notiDom = document.querySelector(\r\n      `form .field .field-description[data-for=${this.dataset.for}]`\r\n    );\r\n    const method = notiDom.classList.contains(\"collapse\") ? \"remove\" : \"add\";\r\n\r\n    notiDom.classList[method](\"collapse\");\r\n  })\r\n);\r\n\r\ndocument\r\n  .querySelectorAll(\"form .field .field-description\")\r\n  .forEach(elem =>\r\n    elem\r\n      .querySelector(\".delete\")\r\n      .addEventListener(\"click\", () => elem.classList.add(\"collapse\"))\r\n  );\r\n","const parseManyFieldNames = (fields, starterObj = {}, delimiter = \"_\") =>\r\n  fields.reduce(\r\n    (obj, field) => parseFieldName(field, obj),\r\n    starterObj,\r\n    delimiter\r\n  );\r\n\r\nconst parseFieldName = (field, starterObj = {}, delimiter = \"_\") => {\r\n  const { name, value } = field;\r\n  const splittedName = name.split(delimiter);\r\n  // Remove form id\r\n  const keys = splittedName.slice(1);\r\n\r\n  keys.reduce((obj, key, index) => {\r\n    const isLastIndex = !keys[index + 1] ? true : false;\r\n\r\n    if (Array.isArray(obj) && isNaN(parseInt(key))) {\r\n      throw new Error(\r\n        \"The key preceded by array must be a numeric value, \" + key + \" given.\"\r\n      );\r\n    }\r\n\r\n    if (isLastIndex) {\r\n      return handleLastIndex(obj, key, value);\r\n    }\r\n\r\n    // Keyname ends with bracket\r\n    const valueShouldBeArray = key.slice(-2) === \"[]\";\r\n\r\n    if (valueShouldBeArray) {\r\n      return handleArrayProperty(obj, key);\r\n    }\r\n\r\n    return handleNormal(obj, key);\r\n  }, starterObj);\r\n\r\n  return starterObj;\r\n};\r\n\r\n/**\r\n * *****\r\n * HELPER FUNCTIONS\r\n * *****\r\n */\r\nconst handleLastIndex = (obj, key, value) => {\r\n  obj[key] = value;\r\n\r\n  return obj;\r\n};\r\nconst handleArrayProperty = (obj, key) => {\r\n  // Remove bracket from keyname then assign new array to it.\r\n  const slicedKey = key.slice(0, -2);\r\n  const prop = obj[slicedKey];\r\n\r\n  // If prop already exists, skip the loop\r\n  // to prevent data overwriting.\r\n  if (isPropExists(obj, slicedKey)) {\r\n    return prop;\r\n  }\r\n\r\n  obj[slicedKey] = [];\r\n\r\n  return obj[slicedKey];\r\n};\r\nconst handleNormal = (obj, key) => {\r\n  // If prop already exists, skip the loop\r\n  // to prevent data overwriting.\r\n  if (isPropExists(obj, key)) {\r\n    return obj[key];\r\n  }\r\n\r\n  // If key is not expected to be array\r\n  // and not the last item, assign new object to it.\r\n  obj[key] = {};\r\n\r\n  return obj[key];\r\n};\r\nconst isPropExists = (obj, key) => typeof obj[key] !== \"undefined\";\r\n\r\nexport { parseFieldName, parseManyFieldNames };\r\n","import * as fieldNameParser from \"../fieldNameParser\";\r\n\r\nfunction handleEachForm(form) {\r\n  const fields = [...form.elements].filter(elem => elem.tagName !== \"BUTTON\");\r\n\r\n  fields.forEach(handleEachField);\r\n\r\n  form.addEventListener(\"submit\", function(e) {\r\n    e.preventDefault();\r\n    fields.forEach(validateField);\r\n\r\n    const liffMessageData = fieldNameParser.parseManyFieldNames(fields);\r\n    // const liffMessageData = createLiffMessageData(fields);\r\n\r\n    console.log(\"The form is submitted!\");\r\n    console.log(\"liffMessageData: \", liffMessageData);\r\n  });\r\n}\r\n\r\nfunction handleEachField(field) {\r\n  field.addEventListener(\"input\", e => validateField(e.target));\r\n}\r\n\r\n// Handle all form submission.\r\ndocument.querySelectorAll(\"form\").forEach(handleEachForm);\r\n\r\n// Handle all submit buttons\r\n// document.querySelectorAll(\".submit-button\").forEach(dom =>\r\n//   dom.addEventListener(\"click\", e => {\r\n//     // e.preventDefault();\r\n//     console.log(\"Submit button is clicked!\");\r\n//   })\r\n// );\r\n\r\n// Should separate concern\r\nfunction validateField(field) {\r\n  const { validity, validationMessage } = field;\r\n  const messageDom = field.parentElement.parentElement.querySelector(\r\n    \".builtin-message\"\r\n  );\r\n\r\n  if (!validity.valid) {\r\n    const message = validity.patternMismatch\r\n      ? field.dataset.errorMessagePattern\r\n      : validationMessage;\r\n\r\n    field.classList.remove(\"is-success\");\r\n    field.classList.add(\"is-danger\");\r\n    messageDom.innerHTML = message || validationMessage;\r\n\r\n    return true;\r\n  } else {\r\n    field.classList.remove(\"is-danger\");\r\n    field.classList.add(\"is-success\");\r\n    messageDom.innerHTML = \"\";\r\n\r\n    return false;\r\n  }\r\n}\r\n","import \"./field-description-effect\";\r\nimport \"./form-validation\";\r\n","import \"./dom\";\r\n"]}